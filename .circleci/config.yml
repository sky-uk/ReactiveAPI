version: 2.1
aliases:
  - &boot_simulator
      name: Boot Simulator
      command: xcrun instruments -w "iPhone 11 (14.0) [" || true
  - &xcode_version
      xcode: 12.0.0
jobs:
  build-and-test:
    macos: *xcode_version
    shell: /bin/bash --login -eo pipefail
    steps:
      - checkout
      - run: boot_simulator
      - run:
          name: Run ReactiveAPI Unit Tests
          command: xcodebuild test -scheme ReactiveAPITests  -destination 'platform=iOS Simulator,name=iPhone 11' | xcpretty
      - run:
          name: Run ReactiveAPI Ext Unit Tests
          command: xcodebuild test -scheme ReactiveAPIExtTests  -destination 'platform=iOS Simulator,name=iPhone 11' | xcpretty

workflows:
  version: 2
  build-test:
    jobs:
      - build-and-test